# Changelog

本文件记录 PixelGrab 各版本的主要变更。

---

## v1.0.7

### Bug Fixes

- **修复菜单截图与 F1 快捷键行为不一致**：修复从系统托盘右键菜单点击"截图"时直接进入选区模式而不显示 F1 工具栏的问题。现在菜单截图与 F1 快捷键行为完全一致，均会显示顶部工具栏（截图/录屏/OCR）并进入选区模式，支持在工具栏中切换模式。同时补齐了录屏中保护条件（`!g_standalone_recording`），防止在独立录屏期间误触发截图。

---

## v1.0.6

### New Features

- **录屏自定义水印**：录屏设置对话框新增"自定义水印"分组，可启用并输入自定义水印文字。水印以黑字白边样式、-25° 旋转角度显示在录屏画面中，5 个实例随机入场、从右上向左下慢速飘移，循环环绕。系统水印保持不变。水印设置通过注册表持久化保存。
- **"关于"对话框展示联系与赞赏二维码**：系统托盘右键菜单"关于"从简单的 MessageBox 升级为自定义 GDI+ 对话框，居中展示联系二维码。

### Improvements

- **录屏水印双轨架构**：系统水印与用户水印独立配置，互不干扰。GPU 与 CPU 双渲染路径均支持。
- **关于对话框保留检查更新功能**：新对话框底部提供"检查更新"和"关闭"按钮。

---

## v1.0.5

### Bug Fixes

- **安装程序在文件复制前终止运行中的进程**：将 `taskkill` 从安装后移至安装前，确保在覆盖文件之前进程已被终止，解决安装时因程序正在运行导致文件被占用无法覆盖的问题。
- **安装时先卸载旧版本再安装**：完整流程为：检测旧版本 → 卸载 → 安装前 kill → 复制新文件。

---

## v1.0.4

### Bug Fixes

- **安装程序自动终止运行中的进程**：NSIS 安装包在安装和卸载时自动执行 `taskkill` 终止正在运行的 PixelGrab.exe。
- **构建脚本自动终止运行中的进程**：`build_and_package.bat` 在构建前自动检测并终止正在运行的 PixelGrab.exe。
- **录屏绿框显示时机修正**：选定录屏区域后绿色边框立即显示在录制设置对话框阶段。

---

## v1.0.3

### New Features

- **标注模式下支持拖拽调整选区大小**：选定区域进入标注模式后，边框显示 8 个拖拽控制点，可随时拖拽调整选区范围。
- **统一选区与标注流程**：点击窗口选取或拖拽绘制选区后直接进入标注模式，无需额外确认步骤。

### Improvements

- **拖拽控制点视觉反馈**：选区/标注边框上绘制 8 个白底黑边方形控制点。
- **动态调整光标**：鼠标悬停到控制点时自动切换为对应方向的调整大小光标。
- **拖拽实时预览**：拖拽调整区域大小时实时显示新区域边框。

### Bug Fixes

- **选区操作不再穿透到背景程序**：通过低级键盘钩子拦截 Enter/Escape 按键。
- **标注模式四周暗色遮罩缺失**：标注模式下现在全程保持四周暗色半透明遮罩。
- **调整大小后全屏闪烁**：通过离屏移动画布窗口和控制 DWM 合成顺序实现无闪烁切换。
- **录屏绿框选区后消失**：选区完成后绿框立即显示并贯穿整个设置与倒计时阶段。

---

## v1.0.2

### Bug Fixes

- **F1 选区模式下收到更新提醒导致鼠标和键盘失效**：在选区/标注/录屏等模式下自动延迟更新弹窗，退出后再显示。

---

## v1.0.0

- 初始发布
